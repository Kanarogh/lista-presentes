<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Presentes - ChÃ¡ de Casa Nova</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body class="gradient-bg min-h-full" id="mainBody">
  
  <div id="landingPage" class="fixed inset-0 z-50 flex flex-col items-center justify-center p-4 overflow-y-auto">
    <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center space-y-6">
        <div class="text-6xl mb-2">ğŸ </div>
        <h1 class="text-3xl font-bold text-green-800">ChÃ¡ de Casa Nova</h1>
        <p class="text-gray-600">Seja bem-vindo(a)! Ficamos muito felizes em compartilhar esse momento com vocÃª.</p>
        
        <div class="space-y-3 pt-4">
            <button onclick="openRSVPModal()" class="w-full bg-green-600 text-white py-3 px-6 rounded-xl font-bold text-lg shadow-lg hover:bg-green-700 hover:shadow-xl transition-all transform hover:-translate-y-1">
                âœ… Confirmar PresenÃ§a
            </button>
            <button onclick="openLoginModal()" class="w-full bg-blue-50 text-blue-700 border-2 border-blue-100 py-3 px-6 rounded-xl font-semibold hover:bg-blue-100 transition-all">
                ğŸ‘‹ JÃ¡ confirmei, quero ver a lista
            </button>
            <button onclick="enterViewOnly()" class="w-full text-gray-500 py-2 hover:text-green-600 text-sm font-medium transition-colors underline">
                Apenas dar uma espiadinha
            </button>
        </div>

        <div class="border-t border-gray-100 pt-6 mt-6">
            <button onclick="openPixModal()" class="text-green-600 font-semibold flex items-center justify-center gap-2 mx-auto hover:bg-green-50 px-4 py-2 rounded-lg transition-colors">
                ğŸ Enviar presente via PIX
            </button>
        </div>

        <div class="pt-4">
            <a href="login.html" class="text-xs text-gray-300 hover:text-gray-500">Sou Administrador</a>
        </div>
    </div>
  </div>

  <div id="mainContent">
      <div class="mode-toggle">
        <button onclick="logoutGuest()" class="bg-white shadow-lg rounded-full px-4 py-2 text-sm font-medium border border-gray-200 hover:shadow-xl transition-all text-red-500">
          ğŸšª Sair
        </button>
      </div>

      <main class="container mx-auto px-4 py-8 max-w-5xl">
        <header class="text-center mb-8 relative">
          <h1 class="text-4xl font-bold text-green-800 mb-4 mt-8">ğŸ  Lista de Presentes</h1>
          <div id="guestWelcome" class="hidden mb-4 bg-green-50 inline-block px-6 py-2 rounded-full text-green-800 border border-green-200 font-semibold"></div>
          <div id="modeIndicator" class="mt-2 inline-flex items-center px-4 py-2 bg-gray-100 text-gray-800 rounded-full text-sm font-medium"></div>
        </header>

        <div class="admin-only text-center mb-8">
          <button onclick="showAddForm()" class="bg-yellow-500 text-white px-6 py-3 rounded-full font-semibold shadow-lg hover:bg-yellow-600 hover:shadow-xl transition-all duration-300">
            âœ¨ Adicionar Presente
          </button>
        </div>

        <div id="addForm" class="admin-only hidden bg-white rounded-2xl shadow-lg p-6 mb-8 border border-green-100 max-w-2xl mx-auto">
          <h3 class="text-xl font-semibold text-green-800 mb-4">Adicionar Novo Presente</h3>
          <p class="text-sm text-gray-500 mb-4">Se a busca automÃ¡tica falhar, use o campo de Imagem Manual.</p>
          <form onsubmit="addItem(event)" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="block text-sm font-medium text-gray-700">Nome</label><input type="text" id="itemName" required class="w-full px-4 py-2 border rounded-lg"></div>
                <div><label class="block text-sm font-medium text-gray-700">Valor</label><input type="text" id="itemPrice" placeholder="R$ 0,00" class="w-full px-4 py-2 border rounded-lg" oninput="maskCurrency(this)"></div>
            </div>
            <div><label class="block text-sm font-medium text-gray-700">Link da Loja</label><input type="url" id="itemLink" required class="w-full px-4 py-2 border rounded-lg"></div>
            <div><label class="block text-sm font-medium text-gray-700">Link Imagem (Manual)</label><input type="url" id="itemImageManual" class="w-full px-4 py-2 border rounded-lg"></div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Categoria</label>
              <select id="itemCategory" class="w-full px-4 py-2 border rounded-lg">
                <option value="Cozinha">ğŸ³ Cozinha</option><option value="Sala">ğŸ›‹ Sala</option><option value="Quarto">ğŸ› Quarto</option><option value="Banheiro">ğŸš¿ Banheiro</option><option value="DecoraÃ§Ã£o">ğŸ¨ DecoraÃ§Ã£o</option><option value="Limpeza">ğŸ§½ Limpeza</option><option value="Outros">ğŸ“¦ Outros</option>
              </select>
            </div>
            <div class="flex gap-3 pt-2">
              <button type="submit" id="btnAddSubmit" class="flex-1 bg-green-600 text-white py-2 rounded-lg">Adicionar</button>
              <button type="button" onclick="hideAddForm()" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg">Cancelar</button>
            </div>
          </form>
        </div>

        <div class="filter-bar">
            <div class="filter-label">
                ğŸ” Filtrar Lista
            </div>
            <div class="filter-inputs">
                <select id="sortFilter" onchange="updateFilters()" class="modern-select">
                    <option value="name">ğŸ”¤ Nome (A-Z)</option><option value="price-asc">ğŸ’° Menor PreÃ§o</option><option value="price-desc">ğŸ’ Maior PreÃ§o</option>
                </select>
                <select id="categoryFilter" onchange="updateFilters()" class="modern-select">
                    <option value="all">ğŸ“‚ Todas Categorias</option><option value="Cozinha">ğŸ³ Cozinha</option><option value="Sala">ğŸ›‹ Sala</option><option value="Quarto">ğŸ› Quarto</option><option value="Banheiro">ğŸš¿ Banheiro</option><option value="DecoraÃ§Ã£o">ğŸ¨ DecoraÃ§Ã£o</option><option value="Limpeza">ğŸ§½ Limpeza</option><option value="Outros">ğŸ“¦ Outros</option>
                </select>
            </div>
        </div>

        <div id="giftListContainer" class="space-y-12">
          <div><h2 id="available-title" class="text-2xl font-bold text-green-700 mb-6 pb-2 border-b-2 border-green-200">ğŸ DisponÃ­veis</h2><div id="availableGiftsList" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3"></div></div>
          <div id="reservedSection"><h2 id="reserved-title" class="text-2xl font-bold text-gray-600 mb-6 pb-2 border-b-2 border-gray-300">âœ… JÃ¡ Reservados</h2><div id="reservedGiftsList" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3"></div></div>
        </div>

        <div id="editModal" class="admin-only hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-2xl"><form onsubmit="updateItem(event)" class="space-y-4"><input type="hidden" id="editItemId"><input type="hidden" id="editItemCurrentImg"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700">Nome</label><input type="text" id="editItemName" required class="w-full px-4 py-2 border rounded-lg"></div><div><label class="block text-sm font-medium text-gray-700">Valor</label><input type="text" id="editItemPrice" oninput="maskCurrency(this)" class="w-full px-4 py-2 border rounded-lg"></div></div><div><label class="block text-sm font-medium text-gray-700">Link</label><input type="url" id="editItemLink" required class="w-full px-4 py-2 border rounded-lg"></div><div><label class="block text-sm font-medium text-gray-700">Imagem Manual</label><input type="url" id="editItemImageManual" class="w-full px-4 py-2 border rounded-lg"></div><div><label class="block text-sm font-medium text-gray-700">Categoria</label><select id="editItemCategory" class="w-full px-4 py-2 border rounded-lg"><option value="Cozinha">ğŸ³ Cozinha</option><option value="Sala">ğŸ›‹ Sala</option><option value="Quarto">ğŸ› Quarto</option><option value="Banheiro">ğŸš¿ Banheiro</option><option value="DecoraÃ§Ã£o">ğŸ¨ DecoraÃ§Ã£o</option><option value="Limpeza">ğŸ§½ Limpeza</option><option value="Outros">ğŸ“¦ Outros</option></select></div><div class="flex gap-3"><button type="submit" id="btnEditSubmit" class="flex-1 bg-green-600 text-white py-2 rounded-lg">Salvar</button><button type="button" onclick="hideEditModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg">Cancelar</button></div></form></div></div>
        
        <div id="reserveModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md"><h3 class="text-2xl font-bold text-green-800 mb-2">Confirmar Escolha</h3><p class="text-gray-600 mb-6">Reservar como <strong id="reserveGuestNameDisplay" class="text-green-700"></strong>?</p><form id="reserveForm" class="space-y-4"><input type="hidden" id="reserveGiftId"><div class="flex gap-3 pt-4"><button type="button" onclick="hideReserveModal()" class="secondary-button">Cancelar</button><button type="submit" class="primary-button">âœ”ï¸ Confirmar</button></div></form></div></div>
      </main>
  </div>

  <div id="rsvpModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[60] p-4"><div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm"><h3 class="text-2xl font-bold text-green-800 mb-2">Confirmar PresenÃ§a</h3><p class="text-gray-600 mb-4 text-sm">Digite seu nome completo.</p><form onsubmit="handleRSVP(event)" class="space-y-4"><input type="text" id="rsvpName" required placeholder="Seu nome completo" class="w-full px-4 py-3 border border-gray-300 rounded-lg"><button type="submit" class="primary-button py-3">âœ”ï¸ Confirmar e Entrar</button><button type="button" onclick="closeModals()" class="secondary-button py-2 border-0">Cancelar</button></form></div></div>
  <div id="loginGuestModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[60] p-4"><div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm"><h3 class="text-2xl font-bold text-blue-800 mb-2">Bem-vindo de volta!</h3><p class="text-gray-600 mb-4 text-sm">Digite o nome que vocÃª usou ao confirmar.</p><form onsubmit="handleGuestLogin(event)" class="space-y-4"><input type="text" id="loginGuestName" required placeholder="Seu nome completo" class="w-full px-4 py-3 border border-gray-300 rounded-lg"><button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold">ğŸš€ Acessar Lista</button><button type="button" onclick="closeModals()" class="secondary-button py-2 border-0">Cancelar</button></form></div></div>
  <div id="pixModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[60] p-4"><div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm text-center"><h3 class="text-xl font-bold text-gray-800 mb-2">Enviar via PIX</h3><div class="bg-gray-100 p-4 rounded-lg mb-4 break-all font-mono text-sm border border-gray-200"><span id="pixKey">SUA_CHAVE_PIX_AQUI</span></div><button onclick="copyPix()" class="text-green-600 font-semibold text-sm hover:underline mb-6">Copiar Chave</button><button type="button" onclick="closeModals()" class="secondary-button w-full">Fechar</button></div></div>

  <script type="module" src="app.js"></script>
</body>
<body class="gradient-bg min-h-full" id="mainBody">

  <div id="initialLoader">
      <div class="loader-icon">ğŸ </div>
      <p class="text-green-800 font-medium animate-pulse">Carregando lista...</p>
  </div>
</html>